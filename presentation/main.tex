\documentclass{beamer}

\usetheme{Hannover}

\usepackage{listings}
\usepackage{fancyvrb}
\usepackage{color}

\title{Erlang: An Introduction}
\author{Lee Avital}


\definecolor{mygreen}{rgb}{0,0.6,0}
\definecolor{mygray}{rgb}{0.5,0.5,0.5}
\definecolor{mymauve}{rgb}{0.58,0,0.82}

\lstset{ %
  backgroundcolor=\color{white},   % choose the background color; you must add \usepackage{color} or \usepackage{xcolor}
  basicstyle=\footnotesize,        % the size of the fonts that are used for the code
    commentstyle=\color{mygreen},    % comment style
    deletekeywords={...},            % if you want to delete keywords from the given language
    escapeinside={\%*}{*)},          % if you want to add LaTeX within your code
    extendedchars=true,              % lets you use non-ASCII characters; for 8-bits encodings only, does not work with UTF-8
    frame=single,                    % adds a frame around the code
    keepspaces=true,                 % keeps spaces in text, useful for keeping indentation of code (possibly needs columns=flexible)
    keywordstyle=\color{blue},       % keyword style
    language=Erlang,                 % the language of the code
    morekeywords={*,...},            % if you want to add more keywords to the set
    showspaces=false,                % show spaces everywhere adding particular underscores; it overrides 'showstringspaces'
    showstringspaces=false,          % underline spaces within strings only
    showtabs=false,                  % show tabs within strings adding particular underscores
    stringstyle=\color{mymauve},     % string literal style
    tabsize=2,                       % sets default tabsize to 2 spaces
}



\begin{document}



\frame{\titlepage}


%%%%%%%%%%%%%%%%%%%%%%%%%
%% SYNTAX FRAME
%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[fragile]
  \frametitle{Simple Syntax}
  \framesubtitle{Three List Length Functions}
  \note{The most prolog like}
  \begin{lstlisting}[language=erlang]
list_length( [] ) -> 0;
list_length( [_H|T] ) -> 1 + list_length( T ).
  \end{lstlisting}

  \note{More ML like}
  \begin{lstlisting}[language=Erlang]
list_length2( L ) ->
  case L of
    [] -> 0;
    [_|T] -> 1 + list_length2( T )
  end.
  \end{lstlisting}


  \note{Tail recursive, More efficient. we can hide the list_length3/2 arity}
  \begin{lstlisting}[language=erlang]
list_length3( L ) -> list_length3( L, 0 ).
list_length3( [], N ) -> N;
list_length3( [_|T], N ) -> list_length3(T, N + 1).
  \end{lstlisting}
\end{frame}











%%%%%%%%%%%%%%%%%%%%%%%%%%
%% PATTERN MATHING FRAME
%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[fragile]
  \frametitle{Powerful Pattern Matching}
  \begin{lstlisting}
read_it( F ) when is_list( F ) ->
  {ok, D} = file:read_file( F ),
  io:format( "~p", [D] ).
  \end{lstlisting}

  \begin{lstlisting}
read_it2( F ) when is_list( F ) ->
  case file:read_file( F ) of
    {ok, D} ->
      io:format( "~p", [D] );
    {error, Err} ->
      io:format( "error: ~p", [Err] )
    end.
  \end{lstlisting}


\end{frame}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Concurrency Primitives
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[fragile]
    \frametitle{Concurrency Primitives}
    \begin{lstlisting}
ping( ) ->
  receive
    {ping, From} ->
      io:format( "ping ~n" ),
      timer:sleep( 500 ),
      From ! {pong, self()}
  end.
pong( ) ->
  timer:sleep( 500 ),
  Ping = spawn( ?MODULE, ping, [] ),
  Ping ! {ping, self()},
  receive
    {pong, _} ->
      io:format( "pong~n" )
  end.
ping_pong() -> pong().

ping_pong_async() -> spawn(?MODULE, pong, [] ).
    \end{lstlisting}

\end{frame}







%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Distributed erlang
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[fragile]

  \frametitle{Distributed Erlang}
  \begin{Verbatim}
    $ erl -sname larry
    (larry) 1> L = fun() ->
      receive {P, Msg} ->
        P ! Msg
      end
    end.
    (larry) 2> register( echo, spawn( L ) ).
    true
  \end{Verbatim}

  \begin{Verbatim}
  $ erl   -sname moe
  (moe) 1> {larry, echo@larry} ! "Hello Larry!"
  "Hello Larry"
  \end{Verbatim}

\end{frame}


\end{document}
